<main id="main" class="main">
  <div class="pagetitle">
    <h1>Profile</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a routerLink="/admin/dashboard">Home</a></li>
        <li class="breadcrumb-item active">Profile</li>
      </ol>
    </nav>
  </div><!-- End Page Title -->

  <!-- Page Content -->
  <div id="page-content-wrapper">
    <div class="container-fluid">
      <div class="row justify-content-center align-items-center dashboard mt-4 mb-5 pb-5">
        <div class="col-sm-12 col-lg-2 d-flex flex-column align-items-center">
          <div class="avatar mt-3">
            <div class="user-online-indicator"></div>
            <img src={{defaulProfile}} alt="user-image" />
          </div>
          <h3 class="text-center mb-0 mt-2">{{user.FirstName}} {{user.LastName}}</h3>
          <p class="text-center">Vaccine Chain System Administration</p>
        </div>

        <div class="col-sm-12 col-lg-10 cycle-tab-container">
          <ul class="nav nav-tabs">
            <li class="cycle-tab-item" (click)="selectTab('profile')">
              <a class="nav-link" [class.active]="selectedTab === 'profile'" href="javascript:void(0)">Profile</a>
            </li>
            <li class="cycle-tab-item" (click)="selectTab('change-password')">
              <a class="nav-link" [class.active]="selectedTab === 'change-password'" href="javascript:void(0)">
                Change Password
              </a>
            </li>
          </ul>

          <div class="tab-content">
            <div class="tab-pane fade" [class.show]="selectedTab === 'profile'"
              [class.active]="selectedTab === 'profile'">
              <form class="form needs-validation" novalidate id="login" [formGroup]="profileForm"
                (ngSubmit)="profileUpdate()">
                <div class="form__input-group d-flex">
                  <i class="bi bi-person-badge"></i>
                  <div class="flex-grow-1 d-flex gap-2">
                    <div class="flex-grow-1">
                      <input type="text" class="form__input col-6" autofocus placeholder="First Name"
                        formControlName="firstName" [class.is-invalid]="firstName.invalid && firstName.touched">
                      @if (firstName.invalid && firstName.touched) {
                      <div class="invalid-feedback text-start ps-1">
                        @if (firstName.errors?.['required']) {
                        <small>Please enter first name</small>
                        }
                      </div>
                      }
                    </div>
                    <div class="flex-grow-1">
                      <input type="text" class="form__input col-6" autofocus placeholder="First Name"
                        formControlName="lastName" [class.is-invalid]="lastName.invalid && lastName.touched">
                      @if (lastName.invalid && lastName.touched) {
                      <div class="invalid-feedback text-start ps-1">
                        @if (lastName.errors?.['required']) {
                        <small>Please enter last name</small>
                        }
                      </div>
                      }
                    </div>
                  </div>
                </div>

                <div class="form__input-group d-flex">
                  <i class="bi bi-envelope"></i>
                  <div class="flex-grow-1">
                    <input type="text" class="form__input" autofocus placeholder="Email" formControlName="email"
                      [class.is-invalid]="email.invalid && email.touched">
                    @if (email.invalid && email.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (email.errors?.['required']) {
                      <small>Please enter email</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <div class="form__input-group d-flex">
                  <i class="bi bi-calendar-event"></i>
                  <div class="flex-grow-1">
                    <input type="date" class="form__input" autofocus placeholder="Birthday"
                      formControlName="dateOfBirth" [class.is-invalid]="dateOfBirth.invalid && dateOfBirth.touched">
                    @if (dateOfBirth.invalid && dateOfBirth.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (dateOfBirth.errors?.['required']) {
                      <small>Please enter your birthday</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <div class="form__input-group d-flex">
                  <i class="bi bi-geo-alt"></i>
                  <div class="flex-grow-1">
                    <input type="text" class="form__input" autofocus placeholder="Address" formControlName="address"
                      [class.is-invalid]="address.invalid && address.touched">
                    @if (address.invalid && address.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (address.errors?.['required']) {
                      <small>Please enter your address</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <button class="btn_save_change btn form__button" type="submit">
                  Save Change
                </button>
              </form>
            </div>

            <div class="tab-pane fade" [class.show]="selectedTab === 'change-password'"
              [class.active]="selectedTab === 'change-password'">
              <form class="form needs-validation" novalidate id="login" [formGroup]="changePasswordForm"
                (ngSubmit)="changePasswordSubmition()">
                <div class="form__input-group d-flex">
                  <i class="bi bi-shield-exclamation"></i>
                  <div class="flex-grow-1">
                    <input type="password" class="form__input" autofocus placeholder="Old Password"
                      formControlName="oldPassword" [class.is-invalid]="oldPassword.invalid && oldPassword.touched">
                    @if (oldPassword.invalid && oldPassword.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (oldPassword.errors?.['required']) {
                      <small>Please enter your old password</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <div class="form__input-group d-flex">
                  <i class="bi bi-shield-plus"></i>
                  <div class="flex-grow-1">
                    <input type="password" class="form__input" autofocus placeholder="New Password"
                      formControlName="password" [class.is-invalid]="password.invalid && password.touched">
                    @if (password.invalid && password.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (password.errors?.['required']) {
                      <small>Please enter your new password</small>
                      }
                      @if (password.errors?.['minlength']) {
                      <small>Please enter at least 8 characters</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <div class="form__input-group d-flex">
                  <i class="bi bi-shield-check"></i>
                  <div class="flex-grow-1">
                    <input type="password" class="form__input" autofocus placeholder="Confirm Password"
                      formControlName="confirmPassword"
                      [class.is-invalid]="confirmPassword.invalid && confirmPassword.touched">
                    @if (confirmPassword.invalid && confirmPassword.touched) {
                    <div class="invalid-feedback text-start ps-1">
                      @if (confirmPassword.errors?.['required']) {
                      <small>Please enter confirm password</small>
                      }
                      @if (confirmPassword.errors?.['mismatch']) {
                      <small>Password and confirmation do not match.</small>
                      }
                    </div>
                    }
                  </div>
                </div>

                <button class="btn_save_change btn form__button" type="submit">
                  Save Change
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- /#page-content-wrapper -->
</main>
